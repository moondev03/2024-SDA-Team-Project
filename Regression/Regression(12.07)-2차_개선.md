## 마지막 업데이트
24.12.07

<br>

## 작성자
60191652 문장훈

<br>

## Regression Analysis (개선 1차)

1. 결측치 처리 개선
    - 결측치 개수 확인 코드 추가
    - ADR 0값과 NaN 값 모두 제거하도록 변경
    - 범주형/수치형 변수 구분하여 결측치 처리
        - 범주형: 최빈값으로 대체
        - 수치형: 중앙값으로 대체

2. ADR 변환 및 세분화
    - log_adr 컬럼 추가 (np.log1p 사용)
    - adr_segment 컬럼 추가 (low, medium, high 3구간)
    - 구간별 독립적인 모델 학습 구조로 변경

3. 모델링 방식 개선
    - 구간별 개별 모델 학습 함수(train_segment_model) 구현
    - 특성 선택 방식 개선
        - 누적 중요도 80% 기준으로 특성 선택
        - 최소 5개 특성 유지하도록 설정
    - 가중 회귀 모델(WLS) 도입
        - 초기 OLS 모델의 잔차 기반 가중치 계산
        - 가중치 적용한 WLS 모델 학습

4. 평가 방식 개선
    - 구간별 모델 통합 평가 함수(evaluate_segment_models) 구현
    - 예측값 역변환 처리 추가 (np.expm1)
    - 전체 구간에 대한 통합 성능 지표 계산

5. PCA 관련 기능 제거
    - 차원 축소 단계 제거
    - 설명된 분산 비율 분석 제거

6. 시각화 간소화
    - ADR 분포 시각화 제거
    - 잔차 vs 예측값 산점도 제거
    - 기본적인 성능 평가 시각화만 유지

<br>

#### 모델 성능 비교

|-|MSE|RMSE|R-squared|
|---|---|---|---|
|Before|1289.9266|35.9155|0.3323|
|After|311.7956|17.6577|0.8204|

|Before|After|
|---|---|
|![alt text](./image/2/image-3.png)|![alt text](./image/3/image.png)|


---

### 예측 수행

- data에서 랜덤한 100개의 샘플을 추출하여 예측 진행
- 전체 성능, 세그먼트별 성능, 개별 예측, 전체 오차 평균을 계산

```
=== 예측 정확도 평가 결과 ===

전체 성능:
MAPE: 13.48%
RMSE: 15.16
R-squared: 0.8352
평균 절대 오차: 11.45
중앙값 절대 오차: 9.40
평균 상대 오차: 13.48%
중앙값 상대 오차: 8.99%

세그먼트별 성능:

LOW 세그먼트:
샘플 수: 33
MAPE: 20.32%
RMSE: 12.61

MEDIUM 세그먼트:
샘플 수: 36
MAPE: 9.56%
RMSE: 10.52

HIGH 세그먼트:
샘플 수: 31
MAPE: 10.74%
RMSE: 21.07

=== 개별 예측 결과 ===

샘플 1 (low 세그먼트):
예측값: 72.30
실제값: 72.00
오차: 0.30 (0.4%)

샘플 2 (low 세그먼트):
예측값: 65.40
실제값: 74.25
오차: 8.85 (11.9%)

샘플 3 (high 세그먼트):
예측값: 134.54
실제값: 130.00
오차: 4.54 (3.5%)

...
```